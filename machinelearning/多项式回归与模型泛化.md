## 多项式回归与模型泛化

### 什么是多项式回归

线性回归模型不能很好的拟合预测数据， 通过增进特征项来达到拟合。


### scikit-learn中的多项式回归

poly = PolynomialFeatures(degree=2)  

就是最高增加2次幂的特征

如有2个特征x1,x2 ,那么会增加4列:
- 全是1的（0次幂）
- x1^2
- x2^2 
- x1*x2 

poly = PolynomialFeatures(degree=3), 就是最高增加3次幂的特征
x1,x2 -> 1,x1,x2,x1^2,x2^2,x1*x2,x1^3,x2^3,x1^2*x2,x2^2*x1




### 欠拟合与过拟合

过拟合：一个假设 **在训练数据上能够获得比其他假设更好的拟合， 但是在测试数据集上却不能很好地拟合数据** (体现在准确率下降)，此时认为这个假设出现了过拟合的现象。(模型过于复杂)

欠拟合：一个假设 **在训练数据上不能获得更好的拟合，并且在测试数据集上也不能很好地拟合数据** ，此时认为这个假设出现了欠拟合的现象。(模型过于简单)

解决方案：L1正则化、L2正则化

#### 欠拟合
**欠拟合产生原因：** 学习到数据的特征过少

解决办法：

- 添加其他特征项，有时出现欠拟合是因为特征项不够导致的，可以添加其他特征项来解决

- 添加多项式特征，模型过于简单时的常用套路，例如将线性模型通过添加二次项或三次项使模型泛化能力更强

#### 过拟合

**过拟合产生原因：** 原始特征过多，存在一些嘈杂特征， 模型过于复杂是因为模型尝试去兼顾所有测试样本

解决办法：

- 重新清洗数据，导致过拟合的一个原因有可能是数据不纯，如果出现了过拟合就需要重新清洗数据。

- 增大数据的训练量，还有一个原因就是我们用于训练的数据量太小导致的，训练数据占总数据的比例过小。

- 正则化

- 减少特征维度


### 学习曲线

随着训练样本的逐渐增多，算法训练出的模型的表现能力。




### 正则化

在解决回归过拟合中，我们选择正则化。但是对于其他机器学习算法如分类算法来说也会出现这样的问题，除了一些算法本身作用之外（决策树、神经网络），我们更多的也是去自己做特征选择，包括之前说的删除、合并一些特征


**在学习的时候，数据提供的特征有些影响模型复杂度或者这个特征的数据点异常较多，所以算法在学习的时候尽量减少这个特征的影响（甚至删除某个特征的影响），这就是正则化**

注：调整时候，算法并不知道某个特征影响，而是去调整参数得出优化的结


**L1正则化**

![](images/ml_29.png)

在损失函数中添加L1正则化项

alpha：  代表惩罚系数（正则化系数) ， 后面是 n个参数ｗ的  L1范数。也是个超参数。 越大惩罚越大。


使用L1正则化线性回归模型 就是 LASSO回归

```python
from sklearn.linear_model import Lasso
```

**L2正则化**

![](images/ml_30.png)

使用L2正则化线性回归模型 就是 Ridge回归

```python
from sklearn.linear_model import Ridge
```

